(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/reportRepair/reportRepair"],{"0535":function(e,t,o){"use strict";var n=o("601e"),i=o.n(n);i.a},"092d":function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(o("93f4"));function i(e){return e&&e.__esModule?e:{default:e}}var a=function(){o.e("components/xfl-select/xfl-select").then(function(){return resolve(o("3510"))}.bind(null,o)).catch(o.oe)},s={components:{xflSelect:a},data:function(){return{isShow:!1,percent:null,imgList:[],imageIndex:0,index:null,complaintIndex:0,roomCloums:[],roomIdArr:[],roomName:"请选择",roomId:"",roomShow:!1,columns:["报修","建议","其他"],typeCds:["809001","809002"],typeName:"请选择",typeCd:"",typeShow:!1,photoList:[],tel:"",context:"",complaintName:"",userId:"",storeId:"",photos:[],communityId:"123",repairList:null,repairTypeList:null,repairListName:["无数据"],repairTypeName:["无数据"]}},onLoad:function(t){var o=this;this.$api.getReports().then((function(t){e.hideLoading(),o.repairList=t.data,console.log(t.data),o.repairListName=o.chooseRepairListName(t.data)})),this.$api.getWarrs().then((function(t){e.hideLoading(),console.log(t),o.repairTypeList=t.data,console.log(t.data),o.repairTypeName=o.chooseRepairListName(t.data)}))},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){},onShareAppMessage:function(){},methods:{chooseRepairListName:function(e,t){var o=[];return e.map((function(e,t){o.push(e.repairname||e.warrname)})),console.log(o),o},chooseRepairId:function(e,t){var o=this;e.map((function(e,n){e.repairname?e.repairname==t&&(o.repairid=e.id):e.warrname==t&&(o.warrid=e.id)}))},ChooseImage:function(t){var o=this;e.chooseImage({count:4,sizeType:["original","compressed"],sourceType:["album"],success:function(t){console.log(JSON.stringify(t.tempFilePaths)),o.$data.imgList.push(t.tempFilePaths[0]);var i=e.uploadFile({url:n.default+"api/upload",filePath:t.tempFilePaths[0],name:"file",formData:{user:"test"},success:function(e){o.isShow=!1,o.photos.push(JSON.parse(e.data).data.fileUrl),console.log(o.photos)}});i.onProgressUpdate((function(e){o.isShow=!0,o.percent=e.progress,console.log("上传进度"+e.progress),console.log("已经上传的数据长度"+e.totalBytesSent),console.log("预期需要上传的数据总长度"+e.totalBytesExpectedToSend)}))}})},deleteImage:function(e){console.log(e);var t=this.$data.imgList;t.splice(e,1)},_changeComplaint:function(e){this.typeName=this.columns[e.detail.value],this.typeCd=this.typeCds[e.detail.value]},_changeRoom:function(e){this.roomName=this.roomCloums[e.detail.value],this.roomId=this.roomIdArr[e.detail.value]},bindInput:function(e){switch(console.log("数据监听",e),e.target.id){case"complaintName":this.$data.complaintName=e.detail.value;break;case"tel":this.$data.tel=e.detail.value;break;case"context":this.$data.context=e.detail.value;break}console.log(this)},bindOwner:function(t){this.chooseRepairId(this.repairList,this.$refs.xfl._data.selectText),this.chooseRepairId(this.repairTypeList,this.$refs.typeRepair._data.selectText),console.log(this.$refs.xfl._data.selectText);var o={userid:e.getStorageSync("clientmessageid"),warrid:this.warrid,repairid:this.repairid,repimgs:null,content:this.context},n=this.photos,i=[];n.forEach((function(e){i.push(e)}));var a="";o.repimgs=i.join(","),""==o.repairid?a="请选择报修项目":""==o.warrid?a="请选择报修类型":""==o.context&&(a="请填写报修内容"),""!=a?wx.showToast({title:a,icon:"none",duration:2e3}):(console.log("提交数据",o),this.$api.saveWorkOrder(o).then((function(t){200==t.code?(e.hideLoading,e.redirectTo({url:"../myRepair/myRepair?id=".concat(e.getStorageSync("clientmessageid"))})):wx.showToast({title:t.msg,icon:"none",duration:2e3})})))},onChange:function(e){console.log(res)},onTypeConfirm:function(e){console.log("onConfirm",e),this.typeName=e.detail.value,this.typeCd=e.detail.index?"809001":"809002",this.typeShow=!1},onTypeCancel:function(e){this.typeShow=!1},chooseType:function(e){this.typeShow=!0},onRoomConfirm:function(e){console.log(this.$refs.xfl),console.log("onConfirm",e)},onRoomCancel:function(e){this.roomShow=!1},chooseRoom:function(e){this.roomShow=!0},afterRead:function(e){var t=e.detail.file,o=this,n=this.photoList,i=void 0===n?[]:n;i.push(t),this.photoList=i,factory.base64.urlTobase64(t.path).then((function(e){o.photos.push(e)})),console.log("data信息：",this)},removePhoto:function(e){console.log(e.detail.index);var t=[];this.photoList.forEach((function(o,n){n!=e.detail.index&&t.push(o)}));var o=[];this.photos.forEach((function(t,n){n!=e.detail.index&&o.push(t)})),this.photos=o,this.photoList=t}}};t.default=s}).call(this,o("543d")["default"])},"601e":function(e,t,o){},"7b65":function(e,t,o){"use strict";o.r(t);var n=o("092d"),i=o.n(n);for(var a in n)"default"!==a&&function(e){o.d(t,e,(function(){return n[e]}))}(a);t["default"]=i.a},"878a":function(e,t,o){"use strict";o.r(t);var n=o("b7f9"),i=o("7b65");for(var a in i)"default"!==a&&function(e){o.d(t,e,(function(){return i[e]}))}(a);o("0535");var s,r=o("f0c5"),c=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);t["default"]=c.exports},aaac:function(e,t,o){"use strict";(function(e){o("c95e");n(o("66fd"));var t=n(o("878a"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},b7f9:function(e,t,o){"use strict";var n={xflSelect:function(){return o.e("components/xfl-select/xfl-select").then(o.bind(null,"3510"))}},i=function(){var e=this,t=e.$createElement;e._self._c},a=[];o.d(t,"b",(function(){return i})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return n}))}},[["aaac","common/runtime","common/vendor"]]]);